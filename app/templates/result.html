{% extends "base.html" %}

{% block content %}

<h2>Processando…</h2>
<div id="status" class="loading">Aguarde...</div>

<div id="resultado"></div>

<script>
    const jobId = "{{ job_id }}";

    function verificar() {
        fetch(`/api/job/${jobId}`)
            .then(r => r.text())
            .then(html => {
                if (html.includes("Processando…")) {
                    // ainda pendente
                    return;
                }
                document.getElementById("resultado").innerHTML = html;
                document.getElementById("status").style.display = "none";
            });
    }

    // poll a cada 1 segundo
    setInterval(verificar, 1000);
</script>

{% endblock %}
